<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard · DataSentinel</title>

    <link rel="stylesheet" href="{{ url_for('static', path='css/app.css') }}">
</head>

<body class="app">

<!-- Topbar -->
<header class="topbar">
    <div class="topbar-left">
        <img src="{{ url_for('static', path='images/logo.png') }}" class="logo-img" />
        <span class="logo-text">DataSentinel</span>
        <span class="status">● System Healthy</span>
    </div>

    <div class="topbar-right">
        <span class="user">{{ user.name }}</span>
        <a href="{{ url_for('logout') }}" class="btn-ghost">Logout</a>
    </div>
</header>

<div class="layout">

    <!-- Sidebar -->
    <aside class="sidebar">

        <!-- Sidebar Header -->
        <div class="sidebar-header">
            Navigation
        </div>
    
        <!-- Core -->
        <div class="sidebar-section">Core</div>
    
        <a class="{% if request.url.path.endswith('/dashboard') %}active{% endif %}"
           href="/datasentinel/dashboard">
            Dashboard
        </a>
    
        <a class="{% if request.url.path.endswith('/validation') %}active{% endif %}"
           href="/datasentinel/validation">
            Validation
        </a>
    
        <a class="{% if request.url.path.endswith('/normalization') %}active{% endif %}"
           href="/datasentinel/normalization">
            Normalization
        </a>
    
        <a class="{% if request.url.path.endswith('/convert') %}active{% endif %}"
           href="/datasentinel/convert">
            Conversion
        </a>
    
        <a class="{% if request.url.path.endswith('/profiling') %}active{% endif %}"
           href="/datasentinel/profiling">
            Profiling
        </a>
    
        <a class="{% if request.url.path.endswith('/prediction') %}active{% endif %}"
           href="/datasentinel/prediction">
            Prediction
        </a>
    
        <div class="sidebar-divider"></div>
    
        <!-- Insights -->
        <div class="sidebar-section">Insights</div>
    
        <a class="{% if request.url.path.endswith('/reports') %}active{% endif %}"
           href="/datasentinel/reports">
            Reports
        </a>
    
        <div class="sidebar-divider"></div>
    
        <!-- System -->
        <div class="sidebar-section">System</div>
    
        <a class="{% if request.url.path.endswith('/settings') %}active{% endif %}"
           href="/datasentinel/settings">
            Settings
        </a>
    
        <a href="/datasentinel/logout">
            Logout
        </a>
    
    </aside>
    
  

    <!-- Main -->
    <main class="content">

        <!-- Overview -->
        <section class="panel">
            <h2>Pipeline Overview</h2>

            <div class="pipeline">
                <div class="stage ok">
                    <span class="stage-name">Validation</span>
                    <span class="stage-meta">{{ stats.validation }} runs</span>
                </div>
                <div class="stage ok">
                    <span class="stage-name">Normalization</span>
                    <span class="stage-meta">{{ stats.normalization }} runs</span>
                </div>
                <div class="stage ok">
                    <span class="stage-name">Conversion</span>
                    <span class="stage-meta">{{ stats.conversion }} runs</span>
                </div>
                <div class="stage ok">
                    <span class="stage-name">Prediction</span>
                    <span class="stage-meta">{{ stats.prediction }} runs</span>
                </div>
            </div>
        </section>

        <!-- Activity -->
        <section class="panel">
            <h2>Recent Activity</h2>

            <table class="table">
                <thead>
                    <tr>
                        <th>Module</th>
                        <th>File</th>
                        <th>Status</th>
                        <th>Timestamp</th>
                    </tr>
                </thead>
                <tbody>
                  {% if history %}
                      {% for r in history[:5] %}
                      <tr>
                          <td>{{ r.module }}</td>
                          <td>{{ r.file }}</td>
                          <td class="ok">{{ r.status }}</td>
                          <td>{{ r.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
                      </tr>
                      {% endfor %}
                  {% else %}
                      <tr>
                          <td colspan="4" style="color:#64748b; text-align:center; padding:20px;">
                              No activity yet. Run a validation, conversion, or normalization to get started.
                          </td>
                      </tr>
                  {% endif %}
              </tbody>
              
            </table>
        </section>

    </main>
</div>

</body>
</html>
